function init(){task_list=store.get("gg")||[],createHtml()}function add_task(t){task_list.push(t),store.set("gg",task_list)}function createHtml(){var t=$(".task-list");t.html(null);for(var a=0;a<task_list.length;a++){var e=binding(task_list[a],a);t.prepend(e)}bindelete(),bindetail(),add_complate()}function binding(t,a){return'<li data-index="'+a+'"><input type="checkbox" '+(t.complated?"checked":"")+' class="complate" ><p class="content">'+t.content+'</p><div class="right"><span class="delete r-main">删除</span><span class="detail r-main">详细</span></div></li>'}function bindelete(){$(".delete.r-main").click(function(){var t=$(this).parent().parent().data(t);remove_task_list(t)})}function remove_task_list(t){confirm("你确定要删除吗?")&&(task_list.splice(t,1),refresh_task_list())}function refresh_task_list(){store.set("gg","task_list"),createHtml()}function bindetail(){$(".detail.r-main").click(function(){var t=$(this).parent().parent().data(t).index;binHtml(t)})}function binHtml(t){var a='<div class="task-detail-mask"></div> <div class="task-detail"><form class="up-task"><h2 class="content">'+task_list[t].content+'</h2><div class="input-item"><input type="text" class="title-detail"></div><div class="input-item"><textarea class="text">'+(task_list[t].text||"")+'</textarea></div><div class="remind input-item"><label for="b">提醒时间</label><input id="b" class="datetime" type="date" value="'+task_list[t].datetime+'"></div><div class="input-item"><button>更新</button></div><div class="colse">X</div></form></div>';$(".container").append(a),remove_detail(),bingenxin(t),altar()}function remove_detail(){$(".task-detail-mask,.colse").click(function(){$(".task-detail-mask,.task-detail").remove()})}function bingenxin(t){$(".up-task").on("submit",function(a){a.preventDefault();var e={};e.content=$(this).find(".content").text(),e.text=$(this).find(".text").val(),e.datetime=$(this).find(".datetime").val(),update(e,t),$(".task-detail-mask,.task-detail").remove(),createHtml()})}function altar(){$(".task-detail .up-task .content").dblclick(function(){var t=$(this),a=$(".container .task-detail .input-item .title-detail");t.hide(),a.show(),a.focus(),a.on("blur",function(){t.show(),a.hide(),a.val()&&t.text(a.val())})})}function add_complate(){$(".complate").click(function(){$(".add-task .complate").click(function(){var t=$(this).parent().parent().data(t).index;task_list[t].complated?update({complated:!1},t):update({complated:!0},t)})})}function update(t,a){task_list[a]=$.extend({},task_list[a],t),store.set("gg",task_list),binHtml(a)}var task_list=[],$add_task=$(".add-task");init(),$add_task.on("submit",function(t){t.preventDefault();var a={};a.content=$add_task.find("input").eq(0).val(),a.content&&(add_task(a),createHtml(),$add_task.find("input").eq(0).val(null))});